[{"path":"https://edm-developers.github.io/fastEDM/articles/chicago.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"Chicago crime/temperature example","text":"demonstrate usefulness EDM estimating impact causal variables, use real-world dataset reflects daily temperature crime levels Chicago, make available chicago.csv file. First, load time series R: Plotting two time series shows:  plotted scatter plot, appears linear correlation variables:  Calculating linear correlation Crime Temperature: shows mild correlation, however causal structure () direction shown.","code":"chicagoURL <- url(\"https://github.com/EDM-Developers/fastEDM-r/raw/main/vignettes/chicago.csv\") chicago <- read.csv(chicagoURL) head(chicago) #>   Time Temperature Crime #> 1    1       24.08  1605 #> 2    2       19.04  1119 #> 3    3       28.04  1127 #> 4    4       30.02  1154 #> 5    5       35.96  1251 #> 6    6       33.08  1276 library(ggplot2)  df <- data.frame(list(   t = rep(chicago$Time, 2),   variable = c(rep(\"Crime\", nrow(chicago)), rep(\"Temperature\", nrow(chicago))),   value = c(chicago$Crime, chicago$Temperature)))  ggplot(df, aes(x = t)) +    geom_line(aes(y = value, color = variable)) +   labs(colour = \"Time series\") ggplot(chicago, aes(x = Temperature, y=Crime)) + geom_point(color=\"#F8766D\") cor(chicago[\"Temperature\"], chicago[\"Crime\"]) #>                Crime #> Temperature 0.461996"},{"path":"https://edm-developers.github.io/fastEDM/articles/chicago.html","id":"find-the-optimal-embedding-dimension","dir":"Articles","previous_headings":"","what":"Find the optimal embedding dimension","title":"Chicago crime/temperature example","text":"Now use edm find optimal embedding dimension Temperature time series. check values \\(E = 2, \\dots 10\\). rho column can see prediction accuracy maximised \\(E = 7\\), take estimate embedding dimension.","code":"library(fastEDM)  # Suppress the progress bar in vignettes, as it confuses knitr. formals(edm)$showProgressBar <- FALSE  res <- edm(chicago[\"Time\"], chicago[\"Temperature\"], E=2:10, numThreads=4) #> Summary of predictions #>    E library theta       rho      mae #> 1  2    2181     1 0.9053390 7.103633 #> 2  3    2181     1 0.9104060 6.880627 #> 3  4    2181     1 0.9169653 6.622584 #> 4  5    2181     1 0.9189371 6.540160 #> 5  6    2181     1 0.9212067 6.491190 #> 6  7    2181     1 0.9225950 6.461038 #> 7  8    2181     1 0.9223688 6.513701 #> 8  9    2181     1 0.9218043 6.541796 #> 9 10    2181     1 0.9218961 6.555065 #> Number of neighbours (k) is set to between 3 and 11"},{"path":"https://edm-developers.github.io/fastEDM/articles/chicago.html","id":"convergent-cross-mapping","dir":"Articles","previous_headings":"","what":"Convergent cross-mapping","title":"Chicago crime/temperature example","text":"edm command can also run cross-mapping task, allows us ascertain causal links crime temperature time series. Note: last two lines computationally demanding. may take minute finish. Choosing machine CPU cores faster cores help significantly. Plotting results gives:  plot, can see one direction shows significant increase accuracy \\(L\\) increases, whereas direction pretty flat. direction increases \\(\\texttt{Temperature} \\mid M(\\texttt{Crime})\\) direction. notation means used \\(\\texttt{Crime}\\) predict \\(\\texttt{Temperature}\\), due backward nature EDM means refers causal link \\(\\texttt{Temperature} \\M(\\texttt{Crime})\\). Therefore, ’d conclude causal link temperature crime, though link reverse direction (implausible).","code":"# Find the maximum library size for the dataset. res <- edm(chicago[\"Time\"], chicago[\"Temperature\"], E=7,            full=TRUE, saveManifolds=TRUE, verbosity=0) libraryMax <- nrow(res$Ms[[1]])  # Choose a linearly spaced grid of library sizes to evaluate the S-map algorithm on. libs <- ceiling(seq(10, libraryMax, length.out=25))  # Run the convergent cross-mapping in each causal direction. crimePredictsTemp <- edm(chicago[\"Time\"], chicago[\"Crime\"], chicago[\"Temperature\"], numReps=2,                          algorithm=\"smap\", E=7, library=libs, k=100, numThreads=4, verbosity=0)  tempPredictsCrime <- edm(chicago[\"Time\"], chicago[\"Temperature\"], chicago[\"Crime\"], numReps=2,                          algorithm=\"smap\", E=7, library=libs, k=100, numThreads=4, verbosity=0) tidyDF <- data.frame(list(   Library = c(     crimePredictsTemp$summary$library,     tempPredictsCrime$summary$library   ),   Direction = c(     rep(\"Temperature | M(Crime)\", nrow(crimePredictsTemp$summary)),     rep(\"Crime | M(Temperature)\", nrow(tempPredictsCrime$summary))   ),   Correlation = c(     crimePredictsTemp$summary$rho,     tempPredictsCrime$summary$rho )))  ggplot(tidyDF, aes(x = Library, y = Correlation)) +   geom_line(aes(color = Direction)) + scale_color_manual(values = c(\"steelblue\", \"darkred\")) +   geom_point(data = tempPredictsCrime$stats, aes(x = library, y = rho), alpha = 0.05, color = \"steelblue\") +   geom_point(data = crimePredictsTemp$stats, aes(x = library, y = rho), alpha = 0.05, color = \"darkred\")"},{"path":"https://edm-developers.github.io/fastEDM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Patrick Laub. Author, maintainer. Jinjing Li. Author. Michael Zyphur. Author. Edoardo Tescari. Contributor. Simon Mutch. Contributor. Rishi Dhushiyandan. Contributor. George Sugihara. Originator.","code":""},{"path":"https://edm-developers.github.io/fastEDM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Laub P, Li J, Zyphur M (2022). fastEDM: Empirical Dynamic Modeling Causal Analysis. R package version 0.1, https://edm-developers.github.io/fastEDM-r.","code":"@Manual{,   title = {fastEDM: Empirical Dynamic Modeling for Causal Analysis},   author = {Patrick Laub and Jinjing Li and Michael Zyphur},   year = {2022},   note = {R package version 0.1},   url = {https://edm-developers.github.io/fastEDM-r}, }"},{"path":"https://edm-developers.github.io/fastEDM/index.html","id":"fastedm-","dir":"","previous_headings":"","what":"Empirical Dynamic Modeling for Causal Analysis","title":"Empirical Dynamic Modeling for Causal Analysis","text":"fastEDM R package implements series Empirical Dynamic Modeling tools can used causal analysis time series data. Key features package: powered fast multi-threaded C++ backend, able process panel data, .k.. multispatial EDM, able handle missing data using new dt algorithms dropping points.","code":""},{"path":"https://edm-developers.github.io/fastEDM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Empirical Dynamic Modeling for Causal Analysis","text":"can install development version fastEDM GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"EDM-Developers/fastEDM-r\")"},{"path":"https://edm-developers.github.io/fastEDM/index.html","id":"example-chicago-crime-levels-and-temperature","dir":"","previous_headings":"","what":"Example: Chicago crime levels and temperature","title":"Empirical Dynamic Modeling for Causal Analysis","text":"example, looking causal links Chicago’s temperature crime rates, described full paper:","code":"library(fastEDM)  chicago <- read.csv(url(\"https://github.com/EDM-Developers/fastEDM-r/raw/main/vignettes/chicago.csv\"))  crimeCCMCausesTemp <- easy_edm(\"Crime\", \"Temperature\", data=chicago, verbosity=0) #> ✖ No evidence of CCM causation from Crime to Temperature found. tempCCMCausesCrime <- easy_edm(\"Temperature\", \"Crime\", data=chicago, verbosity=0) #> ✔ Some evidence of CCM causation from Temperature to Crime found."},{"path":"https://edm-developers.github.io/fastEDM/index.html","id":"stata--python-packages","dir":"","previous_headings":"","what":"Stata & Python Packages","title":"Empirical Dynamic Modeling for Causal Analysis","text":"package R port EDM Stata package. Similarly, creating fastEDM Python package. packages share underlying C++ code, behaviour identical. plan adjust various low-level EDM parameters, check documentation Stata package details options behaviours.","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/easy_edm.html","id":null,"dir":"Reference","previous_headings":"","what":"easy_edm — easy_edm","title":"easy_edm — easy_edm","text":"easy_edm","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/easy_edm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"easy_edm — easy_edm","text":"","code":"easy_edm(   cause,   effect,   time = NULL,   data = NULL,   direction = \"oneway\",   verbosity = 1,   showProgressBar = NULL,   normalize = TRUE )"},{"path":"https://edm-developers.github.io/fastEDM/reference/easy_edm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"easy_edm — easy_edm","text":"cause causal time series (string vector). effect effect time series (string vector). time non-regularly sampled time series, sampling times must supplied (string vector). data dataframe supplied , cause, effect & time arguments must column names relevant time series strings. direction string specifying whether checking one directional causal effect whether test reverse direction time (work progress!). verbosity level detail output. showProgressBar Whether print progress bar computations. normalize Whether normalize inputs starting EDM.","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/easy_edm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"easy_edm — easy_edm","text":"Boolean indicating evidence causation found.","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/easy_edm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"easy_edm — easy_edm","text":"","code":"library(fastEDM)  chicago <- read.csv(url(\"https://github.com/EDM-Developers/fastEDM-r/raw/main/vignettes/chicago.csv\"))  crimeCCMCausesTemp <- easy_edm(\"Crime\", \"Temperature\", data=chicago, verbosity=0) #> ✔ No evidence of CCM causation from Crime to Temperature found. tempCCMCausesCrime <- easy_edm(\"Temperature\", \"Crime\", data=chicago, verbosity=0) #> ✖ Strong evidence of CCM causation from Temperature to Crime found."},{"path":"https://edm-developers.github.io/fastEDM/reference/edm.html","id":null,"dir":"Reference","previous_headings":"","what":"edm — edm","title":"edm — edm","text":"edm","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/edm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"edm — edm","text":"","code":"edm(   t,   x,   y = c(),   panel = c(),   E = 2,   tau = 1,   theta = 1,   library = NULL,   k = 0,   algorithm = \"simplex\",   p = NULL,   crossfold = 0,   full = FALSE,   shuffle = FALSE,   copredict = c(),   savePredictions = FALSE,   saveCoPredictions = FALSE,   saveManifolds = FALSE,   saveSMAPCoeffs = FALSE,   extras = NULL,   allowMissing = FALSE,   missingDistance = 0,   dt = FALSE,   reldt = FALSE,   dtWeight = 0,   numReps = 1,   panelWeight = 0,   panelWeights = NULL,   verbosity = 1,   showProgressBar = NA,   numThreads = 1,   lowMemory = FALSE,   predictWithPast = FALSE )"},{"path":"https://edm-developers.github.io/fastEDM/reference/edm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"edm — edm","text":"t time variable x first variable causal analysis y second variable causal analysis panel data panel data, variable specifies panel ID observation. E option specifies number dimensions \\(E\\) used main variable manifold reconstruction. list numbers provided, command compute results numbers specified. xmap subcommand supports single integer option whereas explore subcommand supports option numlist. default value \\(E\\) 2, theory \\(E\\) can range 2 almost half total sample size. actual \\(E\\) used estimation may different additional variables incorporated. error message provided specified value range. Missing data limit maximum \\(E\\) default deletion method. tau tau (\\(\\tau\\)) option allows researchers specify ‘time delay’, essentially sorts data multiple \\(\\tau\\). done specifying lagged embeddings take form: \\(t,t-\\tau,…,t-(E-1)\\tau\\), default tau=1 (.e., typical lags). However, tau=2 set every-\\(t\\) used reconstruct attractor make predictions—halve observed sample size odd even \\(t\\) used construct set embedding vectors analysis. option helpful data oversampled (.e., spaced closely time) therefore little new information dynamic system added occasion. However, tau setting also useful different dynamics occur different times scales, can chosen reflect researcher’s theory-driven interest specific time-scale (e.g., daily instead hourly). Researchers can evaluate whether \\(\\tau > 1\\) required checking large autocorrelations observed data. course, linear measure association may work well nonlinear systems thus researchers can also check performance examining \\(\\rho\\) MAE different values \\(\\tau\\). theta Theta (\\(\\theta\\)) distance weighting parameter local neighbours manifold. used detect nonlinearity system explore subcommand S-mapping. course, noted , simplex projection CCM weight theta = 1 applied neighbours based distance, reflected fact default value \\(\\theta\\) 1. However, can altered even simplex projection CCM (two cases cover ). Particularly, values S-mapping test improved predictions become local may include theta = c(0, .00001, .0001, .001, .005, .01, .05, .1, .5, 1, 1.5, 2, 3, 4, 6, 8, 10). library option specifies total library size \\(L\\) used manifold reconstruction. Varying library size used estimate convergence property cross-mapping, minimum value \\(L_{min} = E + 2\\) maximum equal total number observations minus sufficient lags (e.g., time-series case without missing data \\(L_{max} = T + 1 - E)\\). error message given \\(L\\) value beyond allowed range. assess rate convergence (.e., rate \\(\\rho\\) increases \\(L\\) grows), full range library sizes small values \\(L\\) can used, \\(E = 2\\) \\(T = 100\\), setting perhaps library = c(seq(4, 25), seq(30, 50, 5), seq(54, 99, 15)). k option specifies number neighbours used prediction. set 1, nearest neighbour used, \\(k\\) increases next-closest nearest neighbours included making predictions. case \\(k\\) set 0, number neighbours used calculated automatically (typically \\(k = E + 1\\) form simplex around target), default value. \\(k = \\infty\\) (e.g., k=Inf), possible points prediction set used (.e., points library used reconstruct manifold predict target vectors). latter setting useful typically recommended S-mapping allows points library used predictions weightings theta. However, large datasets may computationally burdensome therefore k=100 perhaps k=500 may preferred \\(T\\) \\(NT\\) large. algorithm option specifies algorithm used prediction. specified, simplex projection (locally weighted average) used. Valid options include simplex smap, latter sequential locally weighted global linear mapping (S-map noted previously). case xmap subcommand two variables predict , algorithm=\"smap\" invokes something analogous distributed lag model \\(E + 1\\) predictors (including constant term \\(c\\)) , thus, \\(E + 1\\) locally-weighted coefficients predicted observation/target vector—predicted observation type regression done \\(k\\) neighbours rows \\(E + 1\\) coefficients columns. noted , case special options available save coefficients post-processing , , actually regression model instead seen manifold. p option adjusts default number observations ahead predict. parameter can negative. crossfold option asks program run cross-fold validation predicted variables. crossfold(5) indicates 5-fold cross validation. Note used together replicate. full option specified, explore command use possible observations manifold construction instead default 50/50 split. effectively leave-one-cross-validation observation used prediction. shuffle splitting observations library prediction sets, default oldest observations go library set newest observations prediction set. Though randomize option specified, data allocated two sets random fashion. replicate option specified, randomization enabled automatically. copredict option specifies variable used coprediction. second prediction run configuration \\(E\\), library, etc., using library set prediction set built lagged embedding variable. savePredictions option allows save edm predictions useful plotting diagnosis. saveCoPredictions option allows save copredictions. must specify copredict option work. saveManifolds option allows save library prediction manifolds. saveSMAPCoeffs option allows S-map coefficients stored. extras option allows incorporating additional variables embedding (multivariate embedding), e.g. extras=c(y, z). allowMissing option allows observations missing values used manifold. Vectors least one non-missing values used manifold construction. Distance computations adapted allow missing values option specified. missingDistance option allows users specify assumed distance missing values values (including missing) estimating Euclidean distance vector. enables computations missing values. option implies allowmissing. default, distance set expected distance two random draws normal distribution, equals \\(2/\\sqrt{\\pi} \\times\\) standard deviation mapping variable. dt option allows automatic inclusion timestamp differencing embedding. \\(E\\) dt variables included embedding \\(E\\) dimensions. default, weights used additional variables equal standard deviation main mapping variable divided standard deviation time difference. can overridden dtWeight option. dt option ignored running data sampling variation time lags. first dt variable embeds time recent observation time corresponding target/predictand. reldt option, read ‘relative dt’, like dt option includes \\(E\\) extra variables embedding E dimensions. However timestamp differences added time corresponding observations, time target/predictand minus time lagged observations. dtWeight option specifies weight used timestamp differencing variable. numReps number random replications (.e. random splits library prediction sets) run. akin nonparametric bootstrap without replacement, commonly used inference using confidence intervals EDM (Tsonis et al., 2015; van Nes et al., 2015; Ye et al., 2015b). panelWeight specifies penalty added distances points manifold correspond observations different panels. default panelWeight 0, data panels mixed together treatly equally. panelWeight=Inf set weight treated \\(\\infty\\) neighbours never selected cross boundaries panels. Setting panelWeight=Inf k=Inf means may use different number neighbors different predictions (.e. panels unbalanced). panelWeights generalisation panelWeight. Instead giving constant penalty differing panels, panelWeights lets supply matrix panelWeights[, j] added distances points $$-th panel $j$-th panel. verbosity level detail output. showProgressBar Whether print progress bar computations. numThreads number threads use prediction task. lowMemory lowMemory option tries save much space possible efficiently using memory, though small datasets likely slow computations small noticeable amount. predictWithPast Force predictions use contemporaneous data. Normally EDM happy cheat pulling segments future time series make prediction.","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/edm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"edm — edm","text":"list","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/edm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"edm — edm","text":"","code":"t <- c(1, 2, 3, 4, 5, 6, 7, 8) x <- c(11, 12, 13, 14, 15, 16, 17, 18) res <- edm(t, x) #>  Computing: [========================================] 100% (done)                          #> Summary of predictions #>   E library theta        rho     mae #> 1 2       3     1 -0.9706895 2.62881 #> Number of neighbours (k) is set to 3  #"},{"path":"https://edm-developers.github.io/fastEDM/reference/fastEDM.html","id":null,"dir":"Reference","previous_headings":"","what":"fastEDM — fastEDM","title":"fastEDM — fastEDM","text":"fastEDM package implements series tools can used empirical dynamic modeling. core algorithm written C++ achieve reasonable execution speed.","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/fastEDM.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"fastEDM — fastEDM","text":"Jinjing Li, Michael J. Zyphur, George Sugihara, Patrick J. Laub (2021), Beyond Linearity, Stability, Equilibrium: edm Package Empirical Dynamic Modeling Convergent Cross Mapping Stata, Stata Journal, 21(1), pp. 220-258","code":""},{"path":[]},{"path":"https://edm-developers.github.io/fastEDM/reference/fastEDM.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fastEDM — fastEDM","text":"Patrick Laub <patrick.laub@gmail.com>","code":""},{"path":"https://edm-developers.github.io/fastEDM/reference/fastEDM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"fastEDM — fastEDM","text":"","code":"library(fastEDM)  chicago <- read.csv(url(\"https://github.com/EDM-Developers/fastEDM-r/raw/main/vignettes/chicago.csv\"))  crimeCCMCausesTemp <- easy_edm(\"Crime\", \"Temperature\", data=chicago, verbosity=0) #> ✔ No evidence of CCM causation from Crime to Temperature found. tempCCMCausesCrime <- easy_edm(\"Temperature\", \"Crime\", data=chicago, verbosity=0) #> ✖ Strong evidence of CCM causation from Temperature to Crime found."},{"path":"https://edm-developers.github.io/fastEDM/news/index.html","id":"fastedm-01","dir":"Changelog","previous_headings":"","what":"fastEDM 0.1","title":"fastEDM 0.1","text":"Added NEWS.md file track changes package.","code":""}]
