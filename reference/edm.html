<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>edm — edm • fastEDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="edm — edm"><meta name="description" content="This function provides access to the empirical dynamical modelling (EDM)
routines (which are implemented efficiently in C++). The interface is quite
low-level, so beginners are recommended to instead use `easy_edm`."><meta property="og:description" content="This function provides access to the empirical dynamical modelling (EDM)
routines (which are implemented efficiently in C++). The interface is quite
low-level, so beginners are recommended to instead use `easy_edm`."><meta property="og:image" content="https://edm-developers.github.io/fastEDM-r/logo.png"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PB1KPGH2SL"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PB1KPGH2SL');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fastEDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/chicago.html">Chicago crime/temperature example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>edm</h1>

      <div class="d-none name"><code>edm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides access to the empirical dynamical modelling (EDM)
routines (which are implemented efficiently in C++). The interface is quite
low-level, so beginners are recommended to instead use `easy_edm`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">edm</span><span class="op">(</span></span>
<span>  <span class="va">t</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  theta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  library <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"simplex"</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  crossfold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shuffle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  copredict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  savePredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  saveCoPredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  saveManifolds <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  saveSMAPCoeffs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  extras <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  allowMissing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  missingDistance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reldt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dtWeight <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  numReps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  panelWeight <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  panelWeights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  showProgressBar <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  numThreads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lowMemory <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  predictWithPast <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>The time variable</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The first variable in the causal analysis</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The second variable in the causal analysis</p></dd>


<dt id="arg-panel">panel<a class="anchor" aria-label="anchor" href="#arg-panel"></a></dt>
<dd><p>If the data is panel data, then this variable specifies the
panel ID of each observation.</p></dd>


<dt id="arg-e">E<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>This option specifies the number of dimensions \(E\) used for the
main variable in the manifold reconstruction. If a list of numbers is provided, the command will
compute results for all numbers specified. The xmap subcommand only supports a single integer as the
option whereas the explore subcommand supports the option as a numlist. The default value for \(E\) is
2, but in theory \(E\) can range from 2 to almost half of the total sample size. The actual \(E\) used in
the estimation may be different if additional variables are incorporated. A error message is
provided if the specified value is out of range. Missing data will limit the maximum \(E\) under the
default deletion method.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>The tau (or \(\tau\)) option allows researchers to specify the ‘time delay’,
which essentially sorts the data by the multiple \(\tau\). This is done by specifying lagged embeddings
that take the form: \(t,t-\tau,…,t-(E-1)\tau\), where the default is <code>tau=1</code> (i.e., typical lags). However, if
<code>tau=2</code> is set then every-other \(t\) is used to reconstruct the attractor and make predictions—this does
not halve the observed sample size because both odd and even \(t\) would be used to construct the set of
embedding vectors for analysis. This option is helpful when data are oversampled (i.e., spaced too
closely in time) and therefore very little new information about a dynamic system is added at each
occasion. However, the <code>tau</code> setting is also useful if different dynamics occur at different times
scales, and can be chosen to reflect a researcher’s theory-driven interest in a specific time-scale
(e.g., daily instead of hourly). Researchers can evaluate whether \(\tau &gt; 1\) is required by checking for
large autocorrelations in the observed data. Of course, such
a linear measure of association may not work well in nonlinear systems and thus researchers can also
check performance by examining \(\rho\) and MAE at different values of \(\tau\).</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Theta (or \(\theta\)) is the distance weighting parameter for the
local neighbours in the manifold. It is used to detect the nonlinearity of the system in the explore
subcommand for S-mapping. Of course, as noted above, for simplex projection and CCM a weight of
<code>theta = 1</code> is applied to neighbours based on their distance, which is reflected in the fact that the
default value of \(\theta\) is 1. However, this can be altered even for simplex projection or CCM (two cases
that we do not cover here). Particularly, values for S-mapping to test for improved predictions as
they become more local may include</p>
<p><code>theta = c(0, .00001, .0001, .001, .005, .01, .05, .1, .5, 1, 1.5, 2, 3, 4, 6, 8, 10)</code>.</p></dd>


<dt id="arg-library">library<a class="anchor" aria-label="anchor" href="#arg-library"></a></dt>
<dd><p>This option specifies the total library size \(L\) used for
the manifold reconstruction. Varying the library size is used to estimate the convergence property
of the cross-mapping, with a minimum value \(L_{min} = E + 2\) and the maximum equal to the total number of
observations minus sufficient lags (e.g., in the time-series case without missing data this is \(L_{max}
= T + 1 - E)\). An error message is given if the \(L\) value is beyond the allowed range. To assess the
rate of convergence (i.e., the rate at which \(\rho\) increases as \(L\) grows), the full range of library
sizes at small values of \(L\) can be used, such as if \(E = 2\) and \(T = 100\), with the setting then perhaps
being <code>library = c(seq(4, 25), seq(30, 50, 5), seq(54, 99, 15))</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>This option specifies the number of neighbours used for prediction. When
set to 1, only the nearest neighbour is used, but as \(k\) increases the next-closest nearest neighbours
are included for making predictions. In the case that \(k\) is set 0, the number of neighbours used is
calculated automatically (typically as \(k = E + 1\) to form a simplex around a target), which is the
default value. When \(k = \infty\) (e.g., <code>k=Inf</code>), all possible points in the prediction set are used (i.e.,
all points in the library are used to reconstruct the manifold and predict target vectors). This
latter setting is useful and typically recommended for S-mapping because it allows all points in the
library to be used for predictions with the weightings in theta. However, with large datasets this
may be computationally burdensome and therefore <code>k=100</code> or perhaps <code>k=500</code> may be preferred if \(T\) or \(NT\)
is large.</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>This option specifies the algorithm used for prediction. If not
specified, simplex projection (a locally weighted average) is used. Valid options include simplex
and smap, the latter of which is a sequential locally weighted global linear mapping (or S-map as
noted previously). In the case of the xmap subcommand where two variables predict each other, the
<code>algorithm="smap"</code> invokes something analogous to a distributed lag model with \(E + 1\) predictors
(including a constant term \(c\)) and, thus, \(E + 1\) locally-weighted coefficients for each predicted
observation/target vector—because each predicted observation has its own type of regression done
with \(k\) neighbours as rows and \(E + 1\) coefficients as columns. As noted below, in this case special
options are available to save these coefficients for post-processing but, again, it is not actually
a regression model and instead should be seen as a manifold.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>This option adjusts the default number of observations ahead
which we predict.
This parameter can be negative.</p></dd>


<dt id="arg-crossfold">crossfold<a class="anchor" aria-label="anchor" href="#arg-crossfold"></a></dt>
<dd><p>This option asks the program to run a cross-fold validation of the
predicted variables. crossfold(5) indicates a 5-fold cross validation. Note that this cannot be used
together with replicate.</p></dd>


<dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p>When this option is specified, the explore command will use all possible
observations in the manifold construction instead of the default 50/50 split. This is effectively
the same as leave-one-out cross-validation as the observation itself is not used for the prediction.</p></dd>


<dt id="arg-shuffle">shuffle<a class="anchor" aria-label="anchor" href="#arg-shuffle"></a></dt>
<dd><p>When splitting the observations into library and prediction sets, by default
the oldest observations go into the library set and the newest observations to the prediction set.
Though if the randomize option is specified, the data is allocated into the two sets in a random
fashion. If the replicate option is specified, then this randomization is enabled automatically.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>To allow for reproducibility of the internal random number generator, set this seed
to a given integer value.</p></dd>


<dt id="arg-copredict">copredict<a class="anchor" aria-label="anchor" href="#arg-copredict"></a></dt>
<dd><p>This option specifies the variable used for coprediction.
A second prediction is run for each configuration of \(E\), library, etc., using the same library set
but with a prediction set built from the lagged embedding of this variable.</p></dd>


<dt id="arg-savepredictions">savePredictions<a class="anchor" aria-label="anchor" href="#arg-savepredictions"></a></dt>
<dd><p>This option allows you to save the edm predictions
which could be useful for plotting and diagnosis.</p></dd>


<dt id="arg-savecopredictions">saveCoPredictions<a class="anchor" aria-label="anchor" href="#arg-savecopredictions"></a></dt>
<dd><p>This option allows you to save the copredictions.
You must specify the <code>copredict</code> option for this to work.</p></dd>


<dt id="arg-savemanifolds">saveManifolds<a class="anchor" aria-label="anchor" href="#arg-savemanifolds"></a></dt>
<dd><p>This option allows you to save the library and prediction manifolds.</p></dd>


<dt id="arg-savesmapcoeffs">saveSMAPCoeffs<a class="anchor" aria-label="anchor" href="#arg-savesmapcoeffs"></a></dt>
<dd><p>This option allows S-map coefficients to be stored.</p></dd>


<dt id="arg-extras">extras<a class="anchor" aria-label="anchor" href="#arg-extras"></a></dt>
<dd><p>This option allows incorporating additional variables into the
embedding (multivariate embedding), e.g. <code>extras=c(y, z)</code>.</p></dd>


<dt id="arg-allowmissing">allowMissing<a class="anchor" aria-label="anchor" href="#arg-allowmissing"></a></dt>
<dd><p>This option allows observations with missing values to be used in the
manifold. Vectors with at least one non-missing values will be used in the manifold construction.
Distance computations are adapted to allow missing values when this option is specified.</p></dd>


<dt id="arg-missingdistance">missingDistance<a class="anchor" aria-label="anchor" href="#arg-missingdistance"></a></dt>
<dd><p>This option allows users to specify the assumed distance
between missing values and any values (including missing) when estimating the Euclidean distance of
the vector. This enables computations with missing values. The option implies <code>allowmissing</code>. By
default, the distance is set to the expected distance of two random draws in a normal distribution,
which equals to \(2/\sqrt{\pi} \times\) standard deviation of the mapping variable.</p></dd>


<dt id="arg-dt">dt<a class="anchor" aria-label="anchor" href="#arg-dt"></a></dt>
<dd><p>This option allows automatic inclusion of the timestamp differencing in the
embedding. There will be \(E\) dt variables included for an embedding with \(E\) dimensions. By default,
the weights used for these additional variables equal to the standard deviation of the main
mapping variable divided by the standard deviation of the time difference. This can be overridden by
the <code>dtWeight</code> option. The <code>dt</code> option will be ignored when running with data with no sampling
variation in the time lags. The first dt variable embeds the time of the between the most recent
observation and the time of the corresponding target/predictand.</p></dd>


<dt id="arg-reldt">reldt<a class="anchor" aria-label="anchor" href="#arg-reldt"></a></dt>
<dd><p>This option, to be read as ‘relative dt’, is like the <code>dt</code> option above in
that it includes \(E\) extra variables for an embedding with E dimensions. However the timestamp
differences added are not the time between the corresponding observations, but the time of the
target/predictand minus the time of the lagged observations.</p></dd>


<dt id="arg-dtweight">dtWeight<a class="anchor" aria-label="anchor" href="#arg-dtweight"></a></dt>
<dd><p>This option specifies the weight used for the timestamp differencing
variable.</p></dd>


<dt id="arg-numreps">numReps<a class="anchor" aria-label="anchor" href="#arg-numreps"></a></dt>
<dd><p>The number of random replications (i.e. random splits to library and prediction sets) to run.
This is akin to a nonparametric bootstrap without replacement, and is commonly used for
inference using confidence intervals in EDM (Tsonis et al., 2015; van Nes et al., 2015; Ye et al.,
2015b).</p></dd>


<dt id="arg-panelweight">panelWeight<a class="anchor" aria-label="anchor" href="#arg-panelweight"></a></dt>
<dd><p>This specifies a penalty that is added to the distances between points in the
manifold which correspond to observations from different panels. By default <code>panelWeight</code> is 0,
so the data from all panels is mixed together and treatly equally. If <code>panelWeight=Inf</code> is set
then the weight is treated as \(\infty\) so neighbours will never
be selected which cross the boundaries between panels. Setting <code>panelWeight=Inf</code> with
<code>k=Inf</code> means we may use a different number of neighbors for different predictions (i.e.
if the panels are unbalanced).</p></dd>


<dt id="arg-panelweights">panelWeights<a class="anchor" aria-label="anchor" href="#arg-panelweights"></a></dt>
<dd><p>A generalisation of <code>panelWeight</code>. Instead of giving
a constant penalty for differing panels, <code>panelWeights</code> lets you supply a
matrix so <code>panelWeights[i, j]</code> will be added to distances between points
in the $i$-th panel and the $j$-th panel.</p></dd>


<dt id="arg-verbosity">verbosity<a class="anchor" aria-label="anchor" href="#arg-verbosity"></a></dt>
<dd><p>The level of detail in the output.</p></dd>


<dt id="arg-showprogressbar">showProgressBar<a class="anchor" aria-label="anchor" href="#arg-showprogressbar"></a></dt>
<dd><p>Whether or not to print out a progress bar during the computations.</p></dd>


<dt id="arg-numthreads">numThreads<a class="anchor" aria-label="anchor" href="#arg-numthreads"></a></dt>
<dd><p>The number of threads to use for the prediction task.</p></dd>


<dt id="arg-lowmemory">lowMemory<a class="anchor" aria-label="anchor" href="#arg-lowmemory"></a></dt>
<dd><p>The lowMemory option tries to save as much space as possible
by more efficiently using memory, though for small datasets this will likely
slow down the computations by a small but noticeable amount.</p></dd>


<dt id="arg-predictwithpast">predictWithPast<a class="anchor" aria-label="anchor" href="#arg-predictwithpast"></a></dt>
<dd><p>Force all predictions to only use contemporaneous
data. Normally EDM is happy to cheat by pulling segments from the future
of the time series to make a prediction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">edm</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing: [========================================] 100% (done)                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of predictions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   E library theta        rho     mae</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2       3     1 -0.9706895 2.62881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of neighbours (k) is set to 3 </span>
<span class="r-in"><span><span class="co">#</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Laub, Jinjing Li, Michael Zyphur.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

